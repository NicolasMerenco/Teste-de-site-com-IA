<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <title>Cosmos â€” Carl Sagan</title>
  <link rel="shortcut icon" href="imagens/favicon_io2/favicon.ico" type="image/x-icon">
  <meta name="description" content="ColeÃ§Ã£o de episÃ³dios â€” player responsivo, acessÃ­vel e otimizado para publicaÃ§Ã£o.">
  <style>
    :root{
      --bg-1:#020207; --bg-2:#081018; --accent:#00ffcc; --muted:rgba(255,255,255,0.75);
      --card-bg:rgba(8,10,14,0.55); --ui-bg:rgba(0,0,0,0.45); --radius:12px; --max-width:1200px;
      --text:#ffffff; --spinner-size:56px; --particle-color:180,220,255;
    }
    :root[data-theme='light']{ --bg-1:#f6f7fb; --bg-2:#eef3fb; --accent:#006b5f; --text:#051018; --card-bg:rgba(255,255,255,0.9); --ui-bg:rgba(255,255,255,0.9); --particle-color:40,120,140 }

    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family: Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial;color:var(--text);background:linear-gradient(180deg,var(--bg-1),var(--bg-2));-webkit-font-smoothing:antialiased;display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:12px;}

    .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{position:static;width:auto;height:auto;margin:12px;z-index:999;background:#fff;color:#000;padding:8px;border-radius:6px}

    header{width:100%;max-width:var(--max-width);display:flex;align-items:center;justify-content:space-between;padding:10px 6px;gap:10px}
    h1{font-size:clamp(1.2rem,3.2vw,2.2rem);margin:0}

    .header-controls{display:flex;gap:8px;align-items:center}
    .icon-btn{background:var(--ui-bg);border-radius:10px;padding:8px;display:inline-flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.04);cursor:pointer}
    .range{width:140px}

    main{width:100%;max-width:var(--max-width);z-index:2;display:flex;flex-direction:column;align-items:center;gap:18px}
    #universe{position:fixed;inset:0;z-index:0;pointer-events:none}

    .card{width:100%;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:14px;backdrop-filter:blur(6px);box-shadow:0 8px 40px rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.03);position:relative}

    .player-wrap{display:flex;justify-content:center;width:100%}
    .video-container{width:100%;max-width:1000px;border-radius:12px;overflow:hidden;background:#000;box-shadow:0 20px 60px rgba(0,0,0,0.6);position:relative}
    .player-embed{position:relative;width:100%;height:0;padding-bottom:56.25%}
    .player-embed iframe{position:absolute;inset:0;width:100%;height:100%;border:0;display:block}

    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,0.28),rgba(0,0,0,0.4));backdrop-filter:blur(2px)}
    .spinner{width:var(--spinner-size);height:var(--spinner-size);border-radius:50%;border:6px solid rgba(255,255,255,0.08);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .controls{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:12px;flex-wrap:wrap}
    .controls-left{display:flex;gap:8px;align-items:center}
    select{appearance:none;padding:10px 12px;border-radius:10px;border:0;background:var(--card-bg);color:inherit;font-size:1rem}
    button{padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),#00e6b8);color:#001;font-weight:700;cursor:pointer}

    .fallback-panel{display:none;padding:12px;border-radius:10px;background:var(--ui-bg);color:var(--muted);text-align:center;margin-top:12px}
    .fallback-panel.visible{display:block}

    @media (max-width:600px){.controls{flex-direction:column;align-items:stretch}select,button{padding:14px;font-size:1rem;border-radius:12px}.player-embed{padding-bottom:56.25%}}
    @media (min-width:1400px){.video-container{max-width:1280px}}

    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
    footer{width:100%;max-width:var(--max-width);text-align:center;color:var(--muted);font-size:0.9rem;padding:8px}
    @media (prefers-reduced-motion: reduce){.spinner{animation:none}}
  </style>
</head>
<body>
  <a href="#playerEmbed" class="skip-link">Pular para o player</a>
  <canvas id="universe" aria-hidden="true"></canvas>

  <header>
    <h1>ðŸŒŒ Cosmos â€” Carl Sagan</h1>
    <div class="header-controls">
      <button id="themeToggle" class="icon-btn" aria-pressed="false" title="Alternar tema" aria-label="Alternar tema">Tema</button>
      <input id="particleRange" class="range" type="range" min="0" max="100" value="60" aria-label="Intensidade das partÃ­culas">
    </div>
  </header>

  <main id="main" role="main">
    <section class="card" aria-labelledby="player-title">
      <h2 id="player-title" style="margin:0 0 12px 0;font-size:1.05rem">EpisÃ³dios</h2>

      <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:10px">
        <label for="episodes" class="visually-hidden">Escolha o episÃ³dio</label>
        <select id="episodes" aria-label="Escolha o episÃ³dio" style="min-width:160px"></select>

        <div style="display:flex;gap:8px;align-items:center;">
          <button id="prevBtn" aria-label="episÃ³dio anterior">â¬…</button>
          <button id="restartBtn" aria-label="reiniciar episÃ³dio">ðŸ”„</button>
          <button id="nextBtn" aria-label="prÃ³ximo episÃ³dio">âž¡</button>
          <button id="fullscreenBtn" aria-label="tela cheia">â›¶</button>
        </div>
      </div>

      <div class="player-wrap">
        <div class="video-container" role="group" aria-label="player de vÃ­deo">
          <div class="player-embed" id="playerEmbed">
            <iframe id="player" src="about:blank" title="Player de vÃ­deo - Cosmos" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" loading="lazy"></iframe>
            <div class="overlay" id="overlay"><div class="spinner" role="status" aria-live="polite" aria-label="Carregando vÃ­deo"></div></div>
          </div>
        </div>
      </div>

      <div id="fallback" class="fallback-panel">VÃ­deo nÃ£o carregou. <a id="openDrive" href="#" target="_blank" rel="noopener">Abrir no Google Drive</a></div>

      <div role="status" aria-live="polite" style="margin-top:10px;color:var(--muted)" id="status">&nbsp;</div>
    </section>
  </main>

  <script>
    const episodeIds = ['1ewQ-1NTh93tL9yOWF0iDUUcMf2lSM_bU','1ByYI5V-F-a3hwlpHsG14MaZPW15GP47o','1qq2ZQR8jIAarB2N7BUsApVw-KL11AB-t','1gqsPrE2C4G48ErxV-wuswYNRBKGx_LBh','1vGG7chXX2UV34FM1ZfLFjCHOCqj5Yqw-','1yyRFOlKf_FuwhRUnRIOwln6l1tgHvmi1','1b0elQDX0XkpiuOHXp67kmmG5XiZ7LkDQ','1wwULz-VoB8hCzzJK5d9lMIRWSak9CHJ4','1lli-IcZ2Hzm1sjZRr-TPYo00CyvE14fv','1aHcTN8JC-vv0YDzuiLkRDoPOpVxO3t_k','1iVBcoO8RUp6yLqwgoatxt5YvJ3a0jA_7','11I0AcjCdMnMk6cR7VOzbxTB-9TCwJ6fB','1XDeu2197Z1tv_R9lpkWS-TABbnyC20Et'];

    const player = document.getElementById('player');
    const select = document.getElementById('episodes');
    const status = document.getElementById('status');
    const overlay = document.getElementById('overlay');
    const fallback = document.getElementById('fallback');
    const openDrive = document.getElementById('openDrive');

    function populateSelect(){ episodeIds.forEach((id,i)=>{ const opt=document.createElement('option'); opt.value=id; opt.textContent=`EpisÃ³dio ${i+1}`; select.appendChild(opt); }); }
    populateSelect();

    function buildDriveUrl(id){return `https://drive.google.com/file/d/${id}/preview`}
    function updateStatus(msg){ status.textContent=msg }

    function loadEpisode(index,announce=true){ if(index<0) index=episodeIds.length-1; if(index>=episodeIds.length) index=0; select.selectedIndex=index; const url=buildDriveUrl(episodeIds[index]); overlay.style.display='flex'; fallback.classList.remove('visible'); player.src=url; openDrive.href=`https://drive.google.com/file/d/${episodeIds[index]}/view`; if(announce) updateStatus(`EpisÃ³dio ${index+1} carregado`); }

    loadEpisode(0,false);

    let loadTimeout;
    player.addEventListener('load', ()=>{ clearTimeout(loadTimeout); overlay.style.display='none'; fallback.classList.remove('visible'); updateStatus('Pronto'); });
    function startLoadTimeout(){ clearTimeout(loadTimeout); loadTimeout=setTimeout(()=>{ overlay.style.display='none'; fallback.classList.add('visible'); updateStatus('Erro ao carregar - abrir no Drive'); },6000); }

    select.addEventListener('change', ()=>{ loadEpisode(select.selectedIndex); startLoadTimeout(); });
    document.getElementById('nextBtn').addEventListener('click', ()=>{ loadEpisode(select.selectedIndex+1); startLoadTimeout(); });
    document.getElementById('prevBtn').addEventListener('click', ()=>{ loadEpisode(select.selectedIndex-1); startLoadTimeout(); });
    document.getElementById('restartBtn').addEventListener('click', ()=>{ const cur=player.src; player.src=''; overlay.style.display='flex'; setTimeout(()=>player.src=cur,120); startLoadTimeout(); updateStatus('Reiniciado'); });
    document.getElementById('fullscreenBtn').addEventListener('click', ()=>{ const el=document.getElementById('playerEmbed'); if(el.requestFullscreen) el.requestFullscreen(); else if(el.webkitRequestFullscreen) el.webkitRequestFullscreen(); else if(el.msRequestFullscreen) el.msRequestFullscreen(); });

    window.addEventListener('keydown',(e)=>{ if(document.activeElement && (document.activeElement.tagName==='INPUT' || document.activeElement.tagName==='TEXTAREA' || document.activeElement.isContentEditable)) return; if(e.key==='ArrowRight'){ loadEpisode(select.selectedIndex+1); startLoadTimeout(); } if(e.key==='ArrowLeft'){ loadEpisode(select.selectedIndex-1); startLoadTimeout(); } if(e.key.toLowerCase()==='f'){ const el=document.getElementById('playerEmbed'); if(el.requestFullscreen) el.requestFullscreen(); } });

    openDrive.addEventListener('click', ()=>{ updateStatus('Abrindo no Google Drive...'); });
    startLoadTimeout();

    // theme toggle: full theme
    const themeToggle=document.getElementById('themeToggle');
    function setTheme(t){ if(t==='light'){ document.documentElement.setAttribute('data-theme','light'); themeToggle.setAttribute('aria-pressed','true'); } else { document.documentElement.removeAttribute('data-theme'); themeToggle.setAttribute('aria-pressed','false'); } }
    const saved=localStorage.getItem('site-theme'); if(saved) setTheme(saved);
    themeToggle.addEventListener('click', ()=>{ const isLight=document.documentElement.getAttribute('data-theme')==='light'; setTheme(isLight? 'dark':'light'); localStorage.setItem('site-theme', isLight? 'dark':'light'); });

    // particles - improved visuals: twinkle + lighter connections + responsive count
    (function(){ const canvas=document.getElementById('universe'); if(!canvas) return; const ctx=canvas.getContext('2d'); let W=innerWidth,H=innerHeight,DPR=window.devicePixelRatio||1; function resize(){W=innerWidth;H=innerHeight;canvas.width=W*DPR;canvas.height=H*DPR;canvas.style.width=W+'px';canvas.style.height=H+'px';ctx.setTransform(DPR,0,0,DPR,0,0);} resize();
      let baseCount=Math.round((W*H)/110000)+40; if(W<600) baseCount=Math.round((W*H)/160000)+12; const reduced=window.matchMedia('(prefers-reduced-motion: reduce)').matches; let particles=[]; function rand(a,b){return Math.random()*(b-a)+a}
      function init(n){particles.length=0; for(let i=0;i<n;i++){particles.push({x:rand(0,W),y:rand(0,H),r:rand(0.4,2.4),vx:rand(-0.12,0.12),vy:rand(-0.12,0.12),a:rand(0.05,0.95),tw:Math.random()*1.2})}}
      init(baseCount);
      const range=document.getElementById('particleRange'); if(range){ range.addEventListener('input',(e)=>{ const v=Number(e.target.value); const target=Math.round((W*H)/110000*(v/60))+6; init(Math.max(0,Math.min(1200,target))); }); }
      function draw(){ ctx.clearRect(0,0,W,H); const g=ctx.createLinearGradient(0,0,W,H); g.addColorStop(0,'rgba(2,4,8,0.58)'); g.addColorStop(1,'rgba(6,8,12,0.6)'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
        // stars with twinkle
        for(const p of particles){ const hue = getComputedStyle(document.documentElement).getPropertyValue('--particle-color')||'180,220,255'; const alpha = p.a * (0.6 + 0.4*Math.sin(performance.now()*0.002 + p.tw)); ctx.beginPath(); ctx.fillStyle=`rgba(${hue.trim()},${Math.max(0.05,alpha)})`; ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); }
        // faint connections but only on large screens
        if(W>600){ for(let i=0;i<particles.length;i++){ const a=particles[i]; for(let j=i+1;j<particles.length;j++){ const b=particles[j]; const dx=a.x-b.x,dy=a.y-b.y,d=Math.hypot(dx,dy); if(d<80){ ctx.beginPath(); ctx.strokeStyle=`rgba(${getComputedStyle(document.documentElement).getPropertyValue('--particle-color')||'180,220,255'},${(0.06*(1-d/80))*Math.min(a.a,b.a)})`; ctx.lineWidth=0.45; ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke(); } } } }
      }
      function step(){ for(const p of particles){ p.x += p.vx + Math.sin((p.y+performance.now()*0.0003))*0.018; p.y += p.vy + Math.cos((p.x+performance.now()*0.0003))*0.018; if(p.x<0) p.x=W; if(p.x>W) p.x=0; if(p.y<0) p.y=H; if(p.y>H) p.y=0 } draw(); requestAnimationFrame(step); }
      window.addEventListener('resize',()=>{ resize(); baseCount=Math.round((innerWidth*innerHeight)/110000)+40; if(innerWidth<600) baseCount=Math.round((innerWidth*innerHeight)/160000)+12; init(baseCount); });
      if(!reduced) step(); else ctx.clearRect(0,0,W,H);
    })();

  </script>
</body>
</html>
